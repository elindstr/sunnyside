<h1>Invoicing</h1>

{{#if customersCount}}
<section class="info-section">
    <div class="billing-info">
        <label for="end_date">Bill through:</label>
        <input type="date" id="end_date" value="{{today}}">
    </div>
</section>

<section class="info-section">
    <h2>Accounts with uninvoiced services or expenses: {{customersCount}}</h2>
    <table>
        <thead>
            <tr>
                <th>Customer ID</th>
                <th>Name</th>
                <th></th>
            </tr>
        </thead>
        <tbody>
        {{#each customers}}
            <tr>
                <td>{{this.id}}</td>
                <td><a href="/admin/customers/view/{{this.id}}">{{this.first_name}} {{this.last_name}}</a></td>
                <td><button id="generateSingle" onclick="generateSingleInvoice({{this.id}})">Generate</button></td>
            </tr>
        {{/each}}
        </tbody>
    </table>
</section>

<section class="info-section">
    <h2>Batch Invoice (invoice all customers)</h2>
    
    <button class="btn" id="generateBatch" onclick="generateBatchInvoices()">Generate</button><span>(last run on {{lastBatchRun}})</span>
</section>

<section class="info-section">
    <a href="/admin/records/?dateAfter=2000-01-01&dateBefore=2099-01-01&includeInvoice=true&filterByCustomer=any"><button class="btn">View Invoices</button></a>
</section>

{{else}}
<p>No accounts to bill.</p>
{{/if}}


<div id="overlay">
  <div id="text">It may take some time to generate invoices. Please wait.</div>
</div>
<script src="/js/admin-invoices-generator.js"></script>




